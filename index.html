<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Age of Pixels</title>
    <link rel="stylesheet" href="./style.css">
</head>

<body>
    <header class="header">
        <img src="./image/header-logo.png" class="header__logo" alt="header logo">
        <img src="./image/mobile-menu.png" alt="mobile menu" class="header__mobile_menu">
    </header>


    <main class="main">

        <!-- first area -->
        <section class="castle-section">
            <div class="main__hero">
                AGE OF<br>PIXELS
            </div>
            <div class="main__btns">
                <span class="pixel-button">
                    <button class="pixel-button__pressable">
                        Buy on OPENSEA
                    </button>
                </span>
                <span class="pixel-button">
                    <button class="pixel-button__pressable">
                        Play the Game
                    </button>
                </span>
            </div>
        </section>

        <!-- second area -->
        <section class="richard-section">
            <img class="richard-section__hero-image" src="./image/ring-richard.png" alt="richard character">
            <div class="richard-section__wrapper">
                <div class="neon">
                    <h2 class="richard-section__title">AGE OF PIXELS</h2>
                    <p class="richard-section__info">
                        Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been
                        the
                        industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of
                        type
                        and
                        scrambled it to make a type specimen book.
                    </p>
                    <span class="pixel-button">
                        <button class="pixel-button__pressable">
                            navigate to roadmap
                        </button>
                    </span>
                </div>
            </div>
        </section>

        <!-- third area -->
        <section class="roadmap-section">
            <div id="map"></div>
        </section>



    </main>
    <footer class="footer"></footer>

    <script>
        const isMobile = () => window.matchMedia("(max-width: 48rem)").matches;

        const observer = new IntersectionObserver((entries) => {
            if (entries[0].isIntersecting === true) {
                observer.unobserve(entries[0].target);
                const map = document.getElementById('map')
                //
                const perform = async (size) => {
                    var src;
                    if (size == 'mobile') {
                        src = '/image/map/mobile-map.svg'
                        window.mapSize = 'mobile'
                    } else {
                        src = '/image/map/desktop-map.svg'
                        window.mapSize = 'desktop'
                    }

                    map.innerHTML = await (await fetch(src, { 'cache': 'default' })).text()
                    var event = new CustomEvent("svgLoaded", {});
                    document.dispatchEvent(event);
                }
                perform((isMobile() ? 'mobile' : 'desktop'));

                window.addEventListener('resize', () => {
                    if (window.mapSize !== undefined) {
                        const current = (isMobile() ? 'mobile' : 'desktop')
                        if (window.mapSize != current) {
                            perform(current)
                        }
                    }
                });
                //
            }
        }, { threshold: [0], rootMargin: "400px 0px" });

        observer.observe(document.querySelector('.roadmap-section'));
    </script>

    <script>
        document.addEventListener("svgLoaded", function (e) {
            const lands = Array.from(document.querySelectorAll('svg [id^=land]'))
                .forEach((land) => {
                    land.addEventListener('ontouchstart', () => {
                        land.style.fill = 'burlywood !important';
                        land.style.fillOpacity = '0.5';
                        //land.style.stroke = 'rgb(224, 197, 42)';
                        //land.style.strokeOpacity = '0.5';
                    })
                })
        });
    </script>
</body>

</html>